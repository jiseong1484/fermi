
services:
  # Spring Boot 애플리케이션 서비스 (내부망)
  app:
    build: .
    container_name: fermi-app
    restart: always
    # 포트를 내부 네트워크에만 노출 (외부 X)
    expose:
      - "8080"

  # Nginx 리버스 프록시 서비스 (DMZ)
  proxy:
    build: ./nginx
    container_name: fermi-proxy
    restart: always
    # 호스트의 80번 포트를 컨테이너의 80번 포트와 연결 (외부 O)
    ports:
      - "80:80"
    # app 서비스가 실행된 후에 proxy 서비스가 실행되도록 의존성 설정
    depends_on:
      - app
